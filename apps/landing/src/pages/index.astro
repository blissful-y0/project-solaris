---
import BaseLayout from "../layouts/BaseLayout.astro";
import Hero from "../components/Hero";
import World from "../components/World";
import Factions from "../components/Factions";
import System from "../components/System";
import Join from "../components/Join.astro";
import Footer from "../components/Footer.astro";
import "../styles/global.css";
---

<BaseLayout>
  <main>
    <Hero client:load />
    <section id="after-hero" class="after-hero-locked">
      <div id="after-hero-start">
        <World client:visible />
      </div>
      <Factions client:visible />
      <System client:visible />
      <Join />
    </section>
  </main>
  <Footer />
</BaseLayout>

<script is:inline>
  const unlockAfterHero = () => {
    const afterHero = document.getElementById("after-hero");
    const anchor = document.getElementById("after-hero-start");
    if (!afterHero) return;
    afterHero.classList.remove("after-hero-locked");
    afterHero.classList.add("after-hero-unlocked");
    if (anchor) {
      requestAnimationFrame(() => {
        anchor.scrollIntoView({ behavior: "smooth", block: "start" });
      });
    }
  };

  window.addEventListener("solaris:hero-selected", unlockAfterHero, { once: true });
</script>
